#!/usr/bin/env python3
# Analiza parámetros RF para detectar fake gNodeBs

import numpy as np
from rtlsdr import RtlSdr

def scan_5g_band():
    sdr = RtlSdr()
    sdr.sample_rate = 20e6
    sdr.center_freq = 3.7e9  # Banda n78
    sdr.gain = 'auto'

    samples = sdr.read_samples(1024*1024)
    power = np.mean(np.abs(samples)**2)

    if power > 0.1:  # Threshold empírico
        print("[!] Señal anómala detectada - Posible IMSI Catcher")
    
    sdr.close()

scan_5g_band()
